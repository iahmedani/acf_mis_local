<!doctype html>
<html lang="en">

<head>
  <title>OTP Addmision</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
    crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css" crossorigin="anonymous"> -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
    crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="../fa5/css/fontawesome-all.min.css"> -->

</head>
<style>
  tbody>tr>td {
    padding: 0 !important;
    font-size: 12px !important;
  }

  thead {
    font-size: 12px !important;
    font-weight: bold !important;
  }

  #myForm {
    padding-top: 30px;
  }
</style>

<body>
  <header>
    <nav class="navbar navbar-light sticky-top flex-md-nowrap p-0" style="background-color: #e3f2fd;">
      <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">
        <img src="../img/acf-logo.svg" style="height: 50px;" alt="">
      </a>
      <ul class="navbar-nav px-3">

      </ul>
    </nav>
  </header>
  <div class="container-fluid">
    <form action="#" id="myForm">
      <div class="row">
        <div class="form-group col-sm-3 ">
          <label for="province">Province</label>
          <select name="province" id="ddProvince" class="form-control form-control-sm">
            <option selected disabled>Choose</option>

          </select>
        </div>
        <div class="form-group col-sm-3 ">

          <label for="district">District</label>
          <select name="district" id="ddDistrict" class="form-control form-control-sm">
            <option selected disabled>Choose</option>
          </select>
        </div>
        <div class="form-group col-sm-3 ">

          <label for="Tehsil">Tehsil</label>
          <select name="Tehsil" id="ddTehsil" class="form-control form-control-sm">
            <option selected disabled>Choose</option>

          </select>
        </div>
        <div class="form-group col-sm-3 ">
          <label for="uc">UC</label>
          <select name="uc" id="ddUC" class="form-control form-control-sm">
            <option selected disabled>Choose</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-sm-3">

          <label for="site_id" class="form-label">Site Name:</label>

          <select name="site_id" id="ddHealthHouse" class="form-control form-control-sm">
            <option value="">Select One</option>
          </select>
        </div>
        <div class="form-group col-sm-3">

          <label for="prog_type" class="form-label">Program Type:</label>

          <select name="prog_type" id="ddProgramType" class="form-control form-control-sm" required>
            <option value="">Select One</option>
            <option value="sfp">SFP</option>
            <option value="otp">OTP</option>
            <option value="sc">SC</option>
          </select>

        </div>
        <div class="form-group col-sm-3">

          <label for="site_village" class="form-label">Village:</label>

          <input type="text" name="site_village" class="form-control form-control-sm">
        </div>
        <div class="form-group col-sm-3">

          <label for="reg_date" class="form-label">Addmision Date:</label>
          <input type="date" name="reg_date" id="reg_date" class="form-control form-control-sm">
        </div>
        <div class="form-group col-sm-3">

          <label for="reg_id" class="form-label">Registration ID:</label>
          <input type="text" name="reg_id" id="reg_id" class="form-control form-control-sm" maxlength="7">
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <div class="card">
            <div class="card-header"> Addmision Form
            </div>
            <div class="card-body">
              <div id="demo" class="border border-success rounded-top">
                <p class="list-group-item bg-success">Basic Demography</p>
                <div class="row">
                  <div class="form-group col-sm-2">
                    <label for="p_name" class="form-label">Patient Name</label>
                    <input type="text" name="p_name" id="p_name" minlength="2" maxlength="25" class="form-control form-control-sm">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="f_or_h_name" class="form-label">Father/Husband Name</label>
                    <input type="text" name="f_or_h_name" id="f_or_h_name" minlength="2" maxlength="25" class="form-control form-control-sm">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="cnic" class="form-label">CNIC Number</label>
                    <input type="number" name="cnic" id="cnic" minlength="13" maxlength="13" class="form-control form-control-sm">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="address" class="form-label">Address</label>
                    <input type="text" name="address" id="address" class="form-control form-control-sm">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="cnt_number" class="form-label">Contact Number</label>
                    <input type="text" name="cnt_number" id="cnt_number" minlength="11" maxlength="11" class="form-control form-control-sm">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="age" class="form-label">Age</label>
                    <select name="age" id="ager" class="form-control form-control-sm">
                      <option value="below_6"> &lt; 6 Months</option>
                      <option value="range6to23">6 to 23 Month</option>
                      <option value="range24-59">24 to 59 Months</option>
                      <option value="above59"> &gt; 59 Months</option>
                    </select>
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col-sm-2">
                    <label for="gender" class="form-label">Gender</label>
                    <select name="gender" id="gender" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="plw_type" class="form-label">PLW Type</label>
                    <select name="plw_type " id="plw_type" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="p">Pragnent</option>
                      <option value="l">Lactating</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="ent_reason" class="form-label">Entry Reason</label>
                    <select name="ent_reason" id="ent_reason" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="no_prv_pro">No Prv Prog</option>
                      <option value="relapse">Replapse</option>
                      <option value="def_sfp">Def SFP</option>
                      <option value="def_otp">Def OTP</option>
                      <option value="abb_inp">Abbondon INP</option>
                      <option value="moved_in">Moved In</option>
                      <option value="other">Other</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="ref_type">Refferal Type</label>
                    <select name="ref_type" id="ref_type" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="self">Self</option>
                      <option value="chw">CHW</option>
                      <option value="parent">Parent</option>
                      <option value="com_org">Community Org</option>
                      <option value="by_sc_care">By SC Care</option>
                      <option value="by_otp">By OTP</option>
                      <option value="by_sfp">By SFP</option>
                    </select>
                  </div>
                </div>
              </div>
              <div id="anthro" class="border border-secondary rounded-top">
                <p class="list-group-item bg-secondary sm">Addmision Anthropometry</p>
                <div class="row">
                  <div class="form-group col-sm-2">
                    <label for="weight" class="form-label">Weight
                      <small>(KG)</small>
                    </label>
                    <input type="number" name="weight" id="weight" class="form-control form-control-sm" min="0">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="oedema" class="form-label">Oedema</label>
                    <select name="oedema " id="oedema" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="absent">absent</option>
                      <option value="plus_1">&plus;(1)</option>
                      <option value="plus_2">&plus;&plus;(2)</option>
                      <option value="plus_3">&plus;&plus;&plus;(3)</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="muac">MUAC
                      <small>cm</small>
                    </label>
                    <input type="number" name="muac" id="muac" class="form-control form-control-sm">
                  </div>
                </div>
              </div>
              <div id="history" class="border border-secondary rounded-top">
                <p class="list-group-item bg-secondary">History</p>
                <div class="row">
                  <div class="form-group col-sm-1">
                    <label for="diarrhoea">Diarrhoea</label>
                    <select name="diarrhoea" id="diarrhoea" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="1">Yes</option>
                      <option value="0">No</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">

                    <label for="vomiting">Vomiting</label>
                    <select name="vomiting" id="vomiting" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="1">Yes</option>
                      <option value="0">No</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">

                    <label for="cough">Cough</label>
                    <select name="cough" id="cough" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="1">Yes</option>
                      <option value="0">No</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">

                    <label for="appetite">Appetite</label>
                    <select name="appetite" id="appetite" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="good">Good</option>
                      <option value="poor">Poor</option>
                      <option value="none">None</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">

                    <label for="daily_stool">Stools&#047;Day</label>
                    <select name="daily_stool" id="daily_stool" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="bet1_3">1 to 3</option>
                      <option value="bet4_5">4 to 5</option>
                      <option value="gt5">&gt; 5</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-2">

                    <label for="pass_urine">Passing Urine</label>
                    <select name="pass_urine" id="pass_urine" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="1">Yes</option>
                      <option value="0">No</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-2">

                    <label for="b_feeding">Breast Feeding</label>
                    <select name="b_feeding" id="b_feeding" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="1">Yes</option>
                      <option value="0">No</option>
                    </select>
                  </div>
                  <div class="form-group col-sm-3">

                    <label for="od_swol_time">If Oedema, how long swollen?</label>
                    <select name="od_swol_time" id="od_swol_time" class="form-control form-control-sm">
                      <option value="">Choose</option>
                      <option value="absent">absent</option>
                      <option value="plus_1">&plus;(1)</option>
                      <option value="plus_2">&plus;&plus;(2)</option>
                      <option value="plus_3">&plus;&plus;&plus;(3)</option>
                    </select>
                  </div>

                </div>
              </div>
              <div id="anthro" class="border border-secondary rounded-top">
                <p class="list-group-item bg-secondary sm">Ration Supplies</p>
                <div class="row">
                  <div class="form-group col-sm-2">
                    <label for="ration1">Ration 1:</label>
                    <select name="ration1" class="form-control form-control-sm" id="ration1">
                      <option value="RUTF Sachets">RUTF Sachets</option>
                      <option value="Amoxicillin">Amoxicillin</option>
                      <option value="Folic Acid">Folic Acid</option>
                      <option value="MM Sachets">MM Sachets</option>
                      <option value="MM Tablets">MM Tablets</option>
                      <option value="Mebendazole">Mebendazole</option>
                      <option value="Meteronidazole">Meteronidazole</option>
                      <option value="Paracetamol">Paracetamol</option>
                      <option value="Chloroquine">Chloroquine</option>
                      <option value="Zink">Zink</option>
                      <option value="Tertacycline">Tertacycline</option>
                      <option value="Benzyl Benzoate">Benzyl Benzoate</option>
                      <option value="IYCF_Cups_and_Spoons">IYCF Cups &and; Spoons </option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">
                    <label for="quantity1">Quantity:</label>
                    <input type="number" name="quantity1" id="quantity1" class="form-control form-control-sm" min="0">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="ration2">Ration 2:</label>
                    <select name="ration2" class="form-control form-control-sm" id="ration2">
                      <option value="RUTF Sachets">RUTF Sachets</option>
                      <option value="Amoxicillin">Amoxicillin</option>
                      <option value="Folic Acid">Folic Acid</option>
                      <option value="MM Sachets">MM Sachets</option>
                      <option value="MM Tablets">MM Tablets</option>
                      <option value="Mebendazole">Mebendazole</option>
                      <option value="Meteronidazole">Meteronidazole</option>
                      <option value="Paracetamol">Paracetamol</option>
                      <option value="Chloroquine">Chloroquine</option>
                      <option value="Zink">Zink</option>
                      <option value="Tertacycline">Tertacycline</option>
                      <option value="Benzyl Benzoate">Benzyl Benzoate</option>
                      <option value="IYCF_Cups_and_Spoons">IYCF Cups &and; Spoons </option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">
                    <label for="quantity2">Quantity:</label>
                    <input type="number" name="quantity2" id="quantity2" class="form-control form-control-sm" min="0">
                  </div>
                  <div class="form-group col-sm-2">
                    <label for="ration3">Ration 3:</label>
                    <select name="ration3" class="form-control form-control-sm" id="ration3">
                      <option value="RUTF Sachets">RUTF Sachets</option>
                      <option value="Amoxicillin">Amoxicillin</option>
                      <option value="Folic Acid">Folic Acid</option>
                      <option value="MM Sachets">MM Sachets</option>
                      <option value="MM Tablets">MM Tablets</option>
                      <option value="Mebendazole">Mebendazole</option>
                      <option value="Meteronidazole">Meteronidazole</option>
                      <option value="Paracetamol">Paracetamol</option>
                      <option value="Chloroquine">Chloroquine</option>
                      <option value="Zink">Zink</option>
                      <option value="Tertacycline">Tertacycline</option>
                      <option value="Benzyl Benzoate">Benzyl Benzoate</option>
                      <option value="IYCF_Cups_and_Spoons">IYCF Cups &and; Spoons </option>
                    </select>
                  </div>
                  <div class="form-group col-sm-1">
                    <label for="quantity3">Quantity:</label>
                    <input type="number" name="quantity3" id="quantity3" class="form-control form-control-sm" min="0">
                  </div>
                  
                </div>
              </div>
              <button type="submit" class="btn btn-primary btn-sm float-right" id="formSub">Save</button>
            </div>
          </div>
        </div>
      </div>
  </div>

  </form>
  </div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
    crossorigin="anonymous"></script>
  <script>
    window.$ = window.jQuery = require('jquery');
    require('jquery-validation');
  </script>
  <script src="../bower_components/bootstrap/dist/js/bootstrap.bundle.js"></script>
  <script>
    (function ($) {
      $.fn.serializeFormJSON = function () {

        var o = {};
        var a = this.serializeArray();
        $.each(a, function () {
          if (o[this.name]) {
            if (!o[this.name].push) {
              o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
          } else {
            o[this.name] = this.value || '';
          }
        });
        return o;
      };
    })(jQuery);
    const ipc = require('electron').ipcRenderer;
    $('#myForm').validate();
    $('#myForm').on('submit', function (e) {
      if ($(this).valid()) {
        var formData = $(this).serializeFormJSON();
        e.preventDefault();
        ipc.send('submitOtpAdd', formData);
      
      }
    })

    $(function () {
      //Adding Row
      $('#addMore').on('click', function () {
        var data = $("#tb tr:eq(1)").clone(true).appendTo("#tb");
        data.find("input").val('');
      });
      $(document).on('click', '.remove', function () {
        var trIndex = $(this).closest("tr").index();
        if (trIndex > 1) {
          $(this).closest("tr").remove();
        } else {
          alert("Sorry!! Can't remove first row!");
        }
      });
      var datePickerId = document.getElementById('txtScrChildDate');
      datePickerId.max = new Date().toISOString().split("T")[0];
    });
    $(function () {
      ipc.send('getProvince');
      ipc.on('province', function (evt, province) {
        $('#ddProvince').children('option:not(:first)').remove();

        // $('#ddProvince').find('option:gt(0)').remove();
        province.province.forEach(el => {
          $('#ddProvince').append(`<option value="${el.id}">${el.provinceName}</option>`);
        })
      })
      $('#ddProvince').on('change', function () {
        var prov = $(this).val();
        ipc.send('getDistrict', prov)
        ipc.on('district', function (evt, district) {
          $('#ddDistrict').children('option:not(:first)').remove();
          district.district.forEach(el => {
            $('#ddDistrict').append(`<option value="${el.id}">${el.districtName}</option>`);
          })
        })
      })
      $('#ddDistrict').on('change', function () {
        var dist = $(this).val();
        ipc.send('getTehsil', dist)
        ipc.on('tehsil', function (evt, tehsil) {
          $('#ddTehsil').children('option:not(:first)').remove();
          tehsil.tehsil.forEach(el => {
            $('#ddTehsil').append(`<option value="${el.id}">${el.tehsilName}</option>`);
          })
        })
      })
      $('#ddTehsil').on('change', function () {
        var tehs = $(this).val();
        ipc.send('getUC', tehs)
        ipc.on('uc', function (evt, uc) {
          $('#ddUC').children('option:not(:first)').remove();
          uc.uc.forEach(el => {
            $('#ddUC').append(`<option value="${el.id}">${el.ucName}</option>`);
          })
        })
      })
      var ucForHH;
      $('#ddUC').on('change', function () {
        var ucs = $(this).val();
        ucForHH = ucs
        ipc.send('getHealthHouse', ucs)
        ipc.on('hh', function (evt, hh) {
          $('#ddHealthHouse').children('option:not(:first)').remove();
          hh.hh.forEach(el => {
            $('#ddHealthHouse').append(`<option value="${el.id}">${el.siteName}</option>`);
          })
        })
      })
      $('#ddHealthHouse').on('change', function () {
        // var ucs = $('#ddUC').val();
        var h_id = $(this).val();
        ipc.send('getHealthHouseType', h_id)
        ipc.on('hhType', function (evt, hh) {
          // var result = hh.hh.filter(el => el.id == $(this).val());
          if (h_id === "") {
            $('#txtSiteType').val().empty();
          } else {

            $('#txtSiteType').val(function () {
              var site = [];
              if (hh.hh[0].OTP === 1) {
                site.push('OTP')
              }
              if (hh.hh[0].SFP === 1) {
                site.push('SFP')
              }
              if (hh.hh[0].SC === 1) {
                site.push('SC')
              }
              return site;
            })
          }

        })
      })
    })
    ipc.on('resultSent', function (evt, result) {
      $('body').append(`<div class="alert alert-primary" role="alert">
 ${result.msg}
</div>`)
  setTimeout(location.reload(), 2000);
    });
  </script>

</body>

</html>